(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[3596],{3596:(e,t,n)=>{"use strict";n.r(t),n.d(t,{EditimagePageModule:()=>W});var o=n(8583),r=n(665),i=n(3083),c=n(3318);const s="application/font-woff",a="image/jpeg",u={woff:s,woff2:s,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:a,jpeg:a,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml"},l=function(){let e=0;return()=>(e+=1,`u${`0000${(Math.random()*Math.pow(36,4)<<0).toString(36)}`.slice(-4)}${e}`)}();function h(e){const t=function(e){const t=/\.([^./]*?)$/g.exec(e);return t?t[1]:""}(e).toLowerCase();return u[t]||""}function d(e){return-1!==e.search(/^(data:)/)}function f(e,t){return`data:${t};base64,${e}`}function g(e){return e.split(/,/)[1]}function m(e){const t=[];for(let n=0,o=e.length;n<o;n+=1)t.push(e[n]);return t}function p(e,t){const n=window.getComputedStyle(e).getPropertyValue(t);return parseFloat(n.replace("px",""))}function v(e){return new Promise((t,n)=>{const o=new Image;o.onload=()=>t(o),o.onerror=n,o.crossOrigin="anonymous",o.src=e})}const w={};function b(e,t){let n=e.replace(/\?.*/,"");if(/ttf|otf|eot|woff2?/i.test(n)&&(n=n.replace(/.*\//,"")),w[n])return w[n];t.cacheBust&&(e+=(/\?/.test(e)?"&":"?")+(new Date).getTime());const o=(window.fetch?window.fetch(e).then(e=>e.blob().then(t=>({blob:t,contentType:e.headers.get("Content-Type")||""}))).then(({blob:e,contentType:t})=>new Promise((n,o)=>{const r=new FileReader;r.onloadend=()=>n({contentType:t,blob:r.result}),r.onerror=o,r.readAsDataURL(e)})).then(({blob:e,contentType:t})=>({contentType:t,blob:g(e)})):new Promise((t,n)=>{const o=new XMLHttpRequest;o.onreadystatechange=()=>{if(4!==o.readyState)return;if(200!==o.status)return void n(new Error(`Failed to fetch resource: ${e}, status: ${o.status}`));const r=new FileReader;r.onloadend=()=>{t({blob:g(r.result),contentType:o.getResponseHeader("Content-Type")||""})},r.readAsDataURL(o.response)},o.ontimeout=()=>{n(new Error(`Timeout of 30000ms occured while fetching resource: ${e}`))},o.responseType="blob",o.timeout=3e4,o.open("GET",e,!0),o.send()})).catch(n=>{let o="";if(t.imagePlaceholder){const e=t.imagePlaceholder.split(/,/);e&&e[1]&&(o=e[1])}let r=`Failed to fetch resource: ${e}`;return n&&(r="string"==typeof n?n:n.message),r&&console.error(r),o});return w[n]=o,o}var y;!function(e){e.clonePseudoElement=function(e,t,n){const o=window.getComputedStyle(e,n),r=o.getPropertyValue("content");if(""===r||"none"===r)return;const i=l();try{t.className=`${t.className} ${i}`}catch(s){return}const c=document.createElement("style");c.appendChild(function(e,t,n){const o=`.${e}:${t}`,r=n.cssText?function(e){const t=e.getPropertyValue("content");return`${e.cssText} content: '${t.replace(/'|"/g,"")}';`}(n):function(e){return m(e).map(t=>`${t}: ${e.getPropertyValue(t)}${e.getPropertyPriority(t)?" !important":""};`).join(" ")}(n);return document.createTextNode(`${o}{${r}}`)}(i,n,o)),t.appendChild(c)}}(y||(y={}));var P=function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function c(e){try{a(o.next(e))}catch(t){i(t)}}function s(e){try{a(o.throw(e))}catch(t){i(t)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(c,s)}a((o=o.apply(e,t||[])).next())})};function C(e,t,n){return P(this,void 0,void 0,function*(){return n||!t.filter||t.filter(e)?Promise.resolve(e).then(e=>function(e,t){return P(this,void 0,void 0,function*(){if(e instanceof HTMLCanvasElement){const t=e.toDataURL();return"data:,"===t?Promise.resolve(e.cloneNode(!1)):v(t)}return e instanceof HTMLVideoElement&&e.poster?Promise.resolve(e.poster).then(e=>b(e,t)).then(t=>f(t.blob,h(e.poster)||t.contentType)).then(e=>v(e)):Promise.resolve(e.cloneNode(!1))})}(e,t)).then(n=>function(e,t,n){var o;return P(this,void 0,void 0,function*(){const r=m((null!==(o=e.shadowRoot)&&void 0!==o?o:e).childNodes);return 0===r.length?Promise.resolve(t):r.reduce((e,o)=>e.then(()=>C(o,n)).then(e=>{e&&t.appendChild(e)}),Promise.resolve()).then(()=>t)})}(e,n,t)).then(t=>function(e,t){return P(this,void 0,void 0,function*(){return t instanceof Element?Promise.resolve().then(()=>function(e,t){const n=window.getComputedStyle(e),o=t.style;o&&(n.cssText?o.cssText=n.cssText:m(n).forEach(e=>{o.setProperty(e,n.getPropertyValue(e),n.getPropertyPriority(e))}))}(e,t)).then(()=>function(e,t){[":before",":after"].forEach(n=>y.clonePseudoElement(e,t,n))}(e,t)).then(()=>function(e,t){e instanceof HTMLTextAreaElement&&(t.innerHTML=e.value),e instanceof HTMLInputElement&&t.setAttribute("value",e.value)}(e,t)).then(()=>t):t})}(e,t)):Promise.resolve(null)})}const S=/url\((['"]?)([^'"]+?)\1\)/g,x=/url\([^)]+\)\s*format\((["'])([^"']+)\1\)/g,_=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function T(e){return-1!==e.search(S)}function E(e,t,n){if(!T(e))return Promise.resolve(e);const o=function(e,{preferredFontFormat:t}){return t?e.replace(_,e=>{for(;;){const[n,,o]=x.exec(e)||[];if(!o)return"";if(o===t)return`src: ${n};`}}):e}(e,n);return Promise.resolve(o).then(M).then(e=>e.reduce((e,o)=>e.then(e=>function(e,t,n,o,r){const i=n?function(e,t){if(e.match(/^[a-z]+:\/\//i))return e;if(e.match(/^\/\//))return window.location.protocol+e;if(e.match(/^[a-z]+:/i))return e;const n=document.implementation.createHTMLDocument(),o=n.createElement("base"),r=n.createElement("a");return n.head.appendChild(o),n.body.appendChild(r),t&&(o.href=t),r.href=e,r.href}(t,n):t;return Promise.resolve(i).then(e=>b(e,o)).then(e=>"string"==typeof e?f(e,h(t)):f(e.blob,h(t)||e.contentType)).then(n=>e.replace(function(e){return new RegExp(`(url\\(['"]?)(${function(e){return e.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1")}(e)})(['"]?\\))`,"g")}(t),`$1${n}$3`)).then(e=>e,()=>i)}(e,o,t,n)),Promise.resolve(o)))}function M(e){const t=[];return e.replace(S,(e,n,o)=>(t.push(o),e)),t.filter(e=>!d(e))}var R=function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function c(e){try{a(o.next(e))}catch(t){i(t)}}function s(e){try{a(o.throw(e))}catch(t){i(t)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(c,s)}a((o=o.apply(e,t||[])).next())})};function O(e,t){return R(this,void 0,void 0,function*(){return e instanceof Element?Promise.resolve(e).then(e=>function(e,t){var n;return R(this,void 0,void 0,function*(){const o=null===(n=e.style)||void 0===n?void 0:n.getPropertyValue("background");return o?Promise.resolve(o).then(e=>E(e,null,t)).then(t=>(e.style.setProperty("background",t,e.style.getPropertyPriority("background")),e)):Promise.resolve(e)})}(e,t)).then(e=>function(e,t){if(!(e instanceof HTMLImageElement)||d(e.src))return Promise.resolve(e);const n=e.src;return Promise.resolve(n).then(e=>b(e,t)).then(e=>f(e.blob,h(n)||e.contentType)).then(t=>new Promise((n,o)=>{e.onload=n,e.onerror=o,e.srcset="",e.src=t})).then(()=>e,()=>e)}(e,t)).then(e=>function(e,t){return R(this,void 0,void 0,function*(){const n=m(e.childNodes).map(e=>O(e,t));return Promise.all(n).then(()=>e)})}(e,t)):Promise.resolve(e)})}var k=function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function c(e){try{a(o.next(e))}catch(t){i(t)}}function s(e){try{a(o.throw(e))}catch(t){i(t)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(c,s)}a((o=o.apply(e,t||[])).next())})};const N={};function $(e){return e.filter(e=>e.type===CSSRule.FONT_FACE_RULE).filter(e=>T(e.style.getPropertyValue("src")))}function Z(e){if(void 0===e)return[];let t=e;const n=[],o=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi;t=t.replace(/(\/\*[\s\S]*?\*\/)/gi,"");const r=new RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");let i;for(;i=r.exec(t),null!==i;)n.push(i[0]);t=t.replace(r,"");const c=new RegExp("((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})","gi");for(;;){if(i=o.exec(t),null===i){if(i=c.exec(t),null===i)break;o.lastIndex=c.lastIndex}else c.lastIndex=o.lastIndex;n.push(i[0])}return n}function A(e,t){if(N[e])return N[e];const n=fetch(e).then(t=>({url:e,cssText:t.text()}),e=>{console.log("ERROR FETCHING CSS: ",e.toString())});return N[e]=n,n}function L(e){return k(this,void 0,void 0,function*(){return e.cssText.then(t=>{let n=t;const o=/url\(["']?([^"')]+)["']?\)/g,r=(n.match(/url\([^)]+\)/g)||[]).map(t=>{let r=t.replace(o,"$1");return r.startsWith("https://")||(r=new URL(r,e.url).href),new Promise((e,o)=>{fetch(r).then(e=>e.blob()).then(o=>{const r=new FileReader;r.addEventListener("load",o=>{n=n.replace(t,`url(${r.result})`),e([t,r.result])}),r.readAsDataURL(o)}).catch(o)})});return Promise.all(r).then(()=>n)})})}var U=function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function c(e){try{a(o.next(e))}catch(t){i(t)}}function s(e){try{a(o.throw(e))}catch(t){i(t)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(c,s)}a((o=o.apply(e,t||[])).next())})};function I(e,t={}){return{width:t.width||function(e){const t=p(e,"border-left-width"),n=p(e,"border-right-width");return e.clientWidth+t+n}(e),height:t.height||function(e){const t=p(e,"border-top-width"),n=p(e,"border-bottom-width");return e.clientHeight+t+n}(e)}}function D(e,t={}){return U(this,void 0,void 0,function*(){const{width:n,height:o}=I(e,t);return C(e,t,!0).then(e=>function(e,t){return k(this,void 0,void 0,function*(){return(null!=t.fontEmbedCss?Promise.resolve(t.fontEmbedCss):function(e,t){return k(this,void 0,void 0,function*(){return function(e){return k(this,void 0,void 0,function*(){return new Promise((t,n)=>{e.ownerDocument||n(new Error("Provided element is not within a Document")),t(m(e.ownerDocument.styleSheets))}).then(e=>function(e){return k(this,void 0,void 0,function*(){const t=[],n=[];return e.forEach(t=>{if("cssRules"in t)try{m(t.cssRules).forEach((e,o)=>{if(e.type===CSSRule.IMPORT_RULE){let r=o+1;n.push(A(e.href).then(L).then(e=>{Z(e).forEach(e=>{try{t.insertRule(e,e.startsWith("@import")?r+=1:t.cssRules.length)}catch(n){console.log("Error inserting rule from remote css",{rule:e,error:n})}})}).catch(e=>{console.log("Error loading remote css",e.toString())}))}})}catch(o){const r=e.find(e=>null===e.href)||document.styleSheets[0];null!=t.href&&n.push(A(t.href).then(L).then(e=>{Z(e).forEach(e=>{r.insertRule(e,t.cssRules.length)})}).catch(e=>{console.log("Error loading remote stylesheet",e.toString())})),console.log("Error inlining remote css file",o.toString())}}),Promise.all(n).then(()=>(e.forEach(e=>{if("cssRules"in e)try{m(e.cssRules).forEach(e=>{t.push(e)})}catch(n){console.log(`Error while reading CSS rules from ${e.href}`,n.toString())}}),t))})}(e)).then($)})}(e).then(e=>Promise.all(e.map(e=>E(e.cssText,e.parentStyleSheet?e.parentStyleSheet.href:null,t)))).then(e=>e.join("\n"))})}(e,t)).then(t=>{const n=document.createElement("style"),o=document.createTextNode(t);return n.appendChild(o),e.firstChild?e.insertBefore(n,e.firstChild):e.appendChild(n),e})})}(e,t)).then(e=>O(e,t)).then(e=>function(e,t){const{style:n}=e;t.backgroundColor&&(n.backgroundColor=t.backgroundColor),t.width&&(n.width=`${t.width}px`),t.height&&(n.height=`${t.height}px`);const o=t.style;return null!=o&&Object.keys(o).forEach(e=>{n[e]=o[e]}),e}(e,t)).then(e=>function(e,t,n){const o="http://www.w3.org/2000/svg",r=document.createElementNS(o,"svg"),i=document.createElementNS(o,"foreignObject");return r.setAttributeNS("","width",`${t}`),r.setAttributeNS("","height",`${n}`),r.setAttributeNS("","viewBox",`0 0 ${t} ${n}`),i.setAttributeNS("","width","100%"),i.setAttributeNS("","height","100%"),i.setAttributeNS("","x","0"),i.setAttributeNS("","y","0"),i.setAttributeNS("","externalResourcesRequired","true"),r.appendChild(i),i.appendChild(e),function(e){return t=this,o=function*(){return Promise.resolve().then(()=>(new XMLSerializer).serializeToString(e)).then(encodeURIComponent).then(e=>`data:image/svg+xml;charset=utf-8,${e}`)},new((n=void 0)||(n=Promise))(function(e,r){function i(e){try{s(o.next(e))}catch(t){r(t)}}function c(e){try{s(o.throw(e))}catch(t){r(t)}}function s(t){var o;t.done?e(t.value):(o=t.value,o instanceof n?o:new n(function(e){e(o)})).then(i,c)}s((o=o.apply(t,[])).next())});var t,n,o}(r)}(e,n,o))})}var F=n(639),q=n(3071),j=n(5970),z=n(5901);const H=["canvas"],B=["downloadLink"],G=["uploader"];function J(e,t){if(1&e&&F._UZ(0,"img",15),2&e){const e=F.oxw();F.Q6J("src",e.logo,F.LSH)}}const V=[{path:"",component:(()=>{class e{constructor(e,t,n,o,r){this.location=e,this.router=t,this.userService=n,this.alertService=o,this.tokenStorage=r,this.businessName="Company",this.contactNo=1234567890}ngOnInit(){this.getImage(),this.getUser(),this.getBusinessDetails()}getBusinessDetails(){this.userService.getBusinessDetails(this.user_id).subscribe(e=>{null!==e.businessName&&(this.businessName=e.businessName),null!==!e.contactNo&&(this.contactNo=e.contactNo)})}popFileChooser(){this.uploader.nativeElement.click()}onSelectFile(e){if(e.target.files&&e.target.files[0]){let t=new FileReader;t.readAsDataURL(e.target.files[0]),t.onload=e=>{this.logo=e.target.result}}}getImage(){this.image_url=this.userService.getImageFromStorage()}getUser(){let e=this.tokenStorage.DecodeToken();this.user_id=e.user_id,this.business_id=e.business_id}downloadImage(){(function(e,t={}){return U(this,void 0,void 0,function*(){return D(e,t).then(v).then(e=>new Promise(t=>{setTimeout(()=>{t(e)},100)})).then(n=>{const o=document.createElement("canvas"),r=o.getContext("2d"),i=t.pixelRatio||function(){let e,t;try{t=process}catch(o){}const n=t&&t.env?t.env.devicePixelRatio:null;return n&&(e=parseInt(n,10),isNaN(e)&&(e=1)),e||window.devicePixelRatio||1}(),{width:c,height:s}=I(e,t),a=t.canvasWidth||c,u=t.canvasHeight||s;return o.width=a*i,o.height=u*i,o.style.width=`${a}`,o.style.height=`${u}`,t.backgroundColor&&(r.fillStyle=t.backgroundColor,r.fillRect(0,0,o.width,o.height)),r.drawImage(n,0,0,o.width,o.height),o})})})(document.getElementById("image")).then(e=>{this.canvas.nativeElement.src=e.toDataURL(),this.downloadLink.nativeElement.href=e.toDataURL("image/png"),this.downloadLink.nativeElement.download="image.png",this.downloadLink.nativeElement.click(),this.userService.saveEditedImage(e.toDataURL(),this.user_id).subscribe(e=>{this.alertService.presentToast(e.msg,"success"),this.router.navigate(["/home"])})})}ngOnDestroy(){this.userService.remove("image")}}return e.\u0275fac=function(t){return new(t||e)(F.Y36(o.Ye),F.Y36(c.F0),F.Y36(q.K),F.Y36(j.c),F.Y36(z.i))},e.\u0275cmp=F.Xpm({type:e,selectors:[["app-editimage"]],viewQuery:function(e,t){if(1&e&&(F.Gf(H,5),F.Gf(B,5),F.Gf(G,7)),2&e){let e;F.iGM(e=F.CRH())&&(t.canvas=e.first),F.iGM(e=F.CRH())&&(t.downloadLink=e.first),F.iGM(e=F.CRH())&&(t.uploader=e.first)}},decls:27,vars:4,consts:[["slot","start"],["slot","end","id","choose-file",3,"click"],["type","file","accept","image/png, image/gif, image/jpeg","hidden","",3,"change"],["uploader",""],[1,"content"],["id","image"],["id","logo",3,"src",4,"ngIf"],["id","background-img",3,"src"],["id","businessName"],["contenteditable","true"],[3,"click"],["name","cloud-download-outline"],["id","download"],["canvas",""],["downloadLink",""],["id","logo",3,"src"]],template:function(e,t){1&e&&(F.TgZ(0,"ion-header"),F.TgZ(1,"ion-toolbar"),F.TgZ(2,"ion-buttons",0),F._UZ(3,"ion-back-button"),F.qZA(),F.TgZ(4,"ion-button",1),F.NdJ("click",function(){return t.popFileChooser()}),F._uU(5," Upload Logo "),F.TgZ(6,"input",2,3),F.NdJ("change",function(e){return t.onSelectFile(e)}),F.qZA(),F.qZA(),F.qZA(),F.qZA(),F.TgZ(8,"ion-content"),F.TgZ(9,"div",4),F.TgZ(10,"ion-card"),F.TgZ(11,"ion-card-content",5),F.YNc(12,J,1,1,"img",6),F._UZ(13,"ion-img",7),F.TgZ(14,"div",8),F.TgZ(15,"h1",9),F._uU(16),F.qZA(),F.qZA(),F.TgZ(17,"h4",9),F._uU(18),F.qZA(),F.qZA(),F.qZA(),F.TgZ(19,"ion-button",10),F.NdJ("click",function(){return t.downloadImage()}),F._UZ(20,"ion-icon",11),F._uU(21," Download Image "),F.qZA(),F.qZA(),F.TgZ(22,"div",12),F._UZ(23,"img",null,13),F._UZ(25,"a",null,14),F.qZA(),F.qZA()),2&e&&(F.xp6(12),F.Q6J("ngIf",t.logo),F.xp6(1),F.Q6J("src","data:image/png;base64, "+t.image_url),F.xp6(3),F.Oqu(t.businessName),F.xp6(2),F.hij("+91",t.contactNo,""))},directives:[i.Gu,i.sr,i.Sm,i.oU,i.cs,i.YG,i.W2,i.PM,i.FN,o.O5,i.Xz,i.gu],styles:["ion-back-button[_ngcontent-%COMP%]{display:block}#choose-file[_ngcontent-%COMP%]{width:-webkit-fit-content;width:-moz-fit-content;width:fit-content}.content[_ngcontent-%COMP%]{position:relative;display:grid;align-items:center;justify-content:center}.content[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]{z-index:1;display:grid;grid-template-columns:repeat(1,1fr)}.content[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]{position:relative;display:grid;align-items:center;justify-items:center}.content[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   #logo[_ngcontent-%COMP%]{position:absolute;top:4%;left:7%;border-radius:50%;width:55px;height:60px}.content[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   #background-img[_ngcontent-%COMP%]{background-size:cover;background-attachment:fixed}.content[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   #businessName[_ngcontent-%COMP%]{position:absolute;top:3.5%;left:24%;display:flex;align-items:center;text-align:center;justify-content:center;word-break:break-all;z-index:5;height:65px;width:210px}.content[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   #businessName[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{color:#1d1c1c;text-overflow:ellipsis;font-size:1.6rem;font-weight:700}.content[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{position:absolute;z-index:5;color:#1d1c1c;top:13.8%;left:48%;font-weight:700;font-size:.9rem}.content[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{margin:0 1rem;width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;justify-self:center}.content[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{margin-right:1rem}"]}),e})()}];let Y=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=F.oAB({type:e}),e.\u0275inj=F.cJS({imports:[[c.Bz.forChild(V)],c.Bz]}),e})(),W=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=F.oAB({type:e}),e.\u0275inj=F.cJS({imports:[[o.ez,r.u5,i.Pc,Y]]}),e})()}}]);